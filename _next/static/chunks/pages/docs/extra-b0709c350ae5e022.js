(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[776],{9294:function(s,e,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/docs/extra",function(){return l(1289)}])},1289:function(s,e,l){"use strict";l.r(e);var r=l(1527),o=l(985),n=l(6736);l(8823);var i=l(5032);function c(s){let e=Object.assign({h1:"h1",p:"p",h2:"h2",h3:"h3",code:"code",pre:"pre",span:"span",ul:"ul",li:"li",a:"a"},(0,n.ah)(),s.components);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.h1,{children:"拓展内容"}),"\n","\n",(0,r.jsx)(i.UW,{type:"warning",emoji:"⚠️",children:(0,r.jsx)(e.p,{children:"此部分内容将说明一些额外的操作流程，根据自己需要进行配置。"})}),"\n",(0,r.jsx)(e.h2,{id:"反向代理",children:"反向代理"}),"\n",(0,r.jsx)(e.p,{children:"在这里提供双域名（前端和后端各用一个域名）与单域名（前后端共用一个域名）的配置步骤。"}),"\n",(0,r.jsx)(e.p,{children:"当然不管使用哪种方法，都建议用控制面板（如宝塔、1Panel 等）的使用面板提供的反代功能单独粘贴对应的反代配置部分完成配置（需要删掉开头和结尾的 server 块），手写反代配置的大佬随意。"}),"\n",(0,r.jsx)(e.h3,{id:"双域名",children:"双域名"}),"\n",(0,r.jsxs)(e.p,{children:["这里假定前端域名为 ",(0,r.jsx)(e.code,{children:"www.example.com"}),"，后端为 ",(0,r.jsx)(e.code,{children:"server.example.com"}),"。"]}),"\n",(0,r.jsxs)(e.p,{children:["以下是后端 ",(0,r.jsx)(e.code,{children:"server.example.com"})," 反代配置部分"]}),"\n",(0,r.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理开始"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## WebSocket"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"upgrade"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_buffering "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"off;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_http_version "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"1.1; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control no-cache; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## Others"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理结束"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsxs)(e.p,{children:["前端 ",(0,r.jsx)(e.code,{children:"www.example.com"})," 反代部分"]}),"\n",(0,r.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"server{"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\.(gif|png|jpg|css|js|woff|woff2)$ "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" expires "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"30d;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control max-age=60;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Real-IP $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"REMOTE-HOST $remote_addr;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Cache $upstream_cache_status;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" add_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Cache-Control no-cache;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"     "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_intercept_errors "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"on;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsxs)(i.UW,{type:"info",children:[(0,r.jsx)(e.p,{children:"如果您使用此部分示例配置 Nginx 反向代理，您的："}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["API 地址为 ",(0,r.jsx)(e.code,{children:"https://server.example.com/api/v2"})]}),"\n",(0,r.jsxs)(e.li,{children:["前端（Kami/Shiro）地址为 ",(0,r.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,r.jsxs)(e.li,{children:["GateWay 为 ",(0,r.jsx)(e.code,{children:"https://server.example.com"})]}),"\n",(0,r.jsxs)(e.li,{children:["本地后台为 ",(0,r.jsx)(e.code,{children:"https://server.example.com/proxy/qaqdmin"})]}),"\n"]})]}),"\n",(0,r.jsx)(e.h3,{id:"单域名",children:"单域名"}),"\n",(0,r.jsx)(e.p,{children:"以下配置文件以 Nginx 为例，请自行修改 SSL 证书路径以及自己的网站域名。"}),"\n",(0,r.jsxs)(e.p,{children:["若使用 Caddy 进行配置可参考 ",(0,r.jsx)(e.a,{href:"https://github.com/mx-space/docker/blob/master/Caddyfile.example",children:"Caddyfile 文件示例"}),"进行相应修改。"]}),"\n",(0,r.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理开始 "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## WebSocket 地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Upgrade"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_buffering "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"off; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Proto $scheme; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## API 地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /api/v2 {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/api/v2; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 简读 render 地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /render {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/render; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## Kami 地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 后台地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /qaqdmin {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy/qaqdmin;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## RSS 地址"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 反向代理结束"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsx)(e.p,{children:"完整示例如下"}),"\n",(0,r.jsx)(e.pre,{"data-language":"nginx","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"nginx","data-theme":"default",children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"server"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" listen "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"80;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" listen "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"443 ssl http2 ; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-comment)"},children:"## 绑定域名 "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" server_name "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"www.example.com; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" index "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"index.html; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Host $server_name; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"upgrade"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" error_log "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/log/error.log;"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" access_log "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/log/access.log; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /socket.io {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Upgrade $http_upgrade; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Connection "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:'"Upgrade"'}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"Host $host; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-For $proxy_add_x_forwarded_for; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_set_header "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"X-Forwarded-Proto $scheme; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/socket.io; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /api/v2 {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/api/v2; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /render {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/render; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" / {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2323; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" /qaqdmin {"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/proxy/qaqdmin;"})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:" "}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"location"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:"~*"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"\\/(feed|sitemap|atom.xml) "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"{"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"       "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" proxy_pass "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"http://127.0.0.1:2333/$1; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    }"})}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_certificate "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/ssl/fullchain.pem; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_certificate_key "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"/www/sites/www.example.com/ssl/privkey.pem; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_protocols "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"TLSv1.3 TLSv1.2 TLSv1.1 TLSv1; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_ciphers "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string-expression)"},children:"'ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!3DES:!MD5:!PSK'"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_prefer_server_ciphers "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"on; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_session_cache "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"shared:SSL:10m; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" ssl_session_timeout "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"10m; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" error_page "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"497 https://$host$request_uri; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_conn "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"perserver "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"300"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_conn "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"perip "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-constant)"},children:"25"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"; "})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"   "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-keyword)"},children:" limit_rate "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"512k; "})]}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"}"})})]})}),"\n",(0,r.jsxs)(i.UW,{type:"info",children:[(0,r.jsx)(e.p,{children:"如果您使用此部分示例配置 Nginx 反向代理，您的："}),(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["API 地址为 ",(0,r.jsx)(e.code,{children:"https://www.example.com/api/v2"})]}),"\n",(0,r.jsxs)(e.li,{children:["前端（Kami/Shiro）地址为 ",(0,r.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,r.jsxs)(e.li,{children:["GateWay 为 ",(0,r.jsx)(e.code,{children:"https://www.example.com"})]}),"\n",(0,r.jsxs)(e.li,{children:["本地后台为 ",(0,r.jsx)(e.code,{children:"https://www.example.com/proxy/qaqdmin"})]}),"\n"]})]}),"\n",(0,r.jsx)(e.h2,{id:"配置其他-redis-服务",children:"配置其他 Redis 服务"}),"\n",(0,r.jsxs)(e.p,{children:["如果你需要使用来自 (远端 / 非容器) 的 Redis 服务，你可以通过使用 ",(0,r.jsx)(e.code,{children:"argv"})," 来动态传入对应的配置项。"]}),"\n",(0,r.jsx)(e.p,{children:"支持传入如下值："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"redis_host"})," Redis 服务地址，域名、IP 都可以"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"redis_port"})," Redis 服务端口"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"redis_password"})," Redis 服务密码"]}),"\n"]}),"\n",(0,r.jsx)(e.p,{children:"在默认情况下，我们认为这样已经足够了。"}),"\n",(0,r.jsx)(e.h3,{id:"对于进阶部署",children:"对于进阶部署"}),"\n",(0,r.jsxs)(e.p,{children:["针对这种部署方式，我们可以修改 ",(0,r.jsx)(e.code,{children:"ecosystem.config.js"})," 在 12 行，也就是 ",(0,r.jsx)(e.code,{children:"script"})," 这一项，添加你需要传入的值，如下所示："]}),"\n",(0,r.jsx)(e.pre,{"data-language":"diff","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"diff","data-theme":"default",children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { cpus } = require('os')"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { execSync } = require('child_process')"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const nodePath = execSync(`npm root --quiet -g`, { encoding: 'utf-8' }).split("})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  '\\n',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")[0]"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:" "}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const cpuLen = cpus().length"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"module.exports = {"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  apps: ["})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      name: 'mx-server',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#EF6270"},children:"-     script: 'out/index.js,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#4BB74A"},children:"+     script: 'out/index.js --redis_host=远端地址 --redis_password=redis?passwd',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      autorestart: true,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      exec_mode: 'cluster',"})})]})}),"\n",(0,r.jsx)(e.p,{children:"当你修改完成，你需要重新构建，并重启服务："}),"\n",(0,r.jsx)(e.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"bundle"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"prod:pm2"})]})]})}),"\n",(0,r.jsx)(e.h2,{id:"配置其他-mongodb-服务",children:"配置其他 MongoDB 服务"}),"\n",(0,r.jsxs)(e.p,{children:["如果你需要使用来自 (远端 / 非容器) 的 MongoDB 服务，你可以通过使用 ",(0,r.jsx)(e.code,{children:"argv"})," 来动态传入对应的配置项。"]}),"\n",(0,r.jsx)(e.p,{children:"支持传入如下值："}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"collection_name"})," 数据库集合名字"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"db_host"})," MongoDB 服务地址，域名、IP 都可以"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"db_port"})," MongoDB 服务端口"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"db_user"})," MongoDB 服务用户名"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.code,{children:"db_password"})," MongoDB 服务密码"]}),"\n"]}),"\n",(0,r.jsx)(i.UW,{type:"warning",emoji:"⚠️",children:(0,r.jsx)(e.p,{children:"如果你需要使用密码登录，你不仅仅需要传入 password，还需要传入 user，建议你对数据库集合划分好用户权限"})}),"\n",(0,r.jsx)(e.h3,{id:"对于进阶部署-1",children:"对于进阶部署"}),"\n",(0,r.jsxs)(e.p,{children:["和 Redis 一样，我们可以修改 ",(0,r.jsx)(e.code,{children:"ecosystem.config.js"})," 在 12 行，也就是 ",(0,r.jsx)(e.code,{children:"script"})," 这一项，添加你需要传入的值，如下所示："]}),"\n",(0,r.jsx)(e.pre,{"data-language":"diff","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"diff","data-theme":"default",children:[(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { cpus } = require('os')"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const { execSync } = require('child_process')"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const nodePath = execSync(`npm root --quiet -g`, { encoding: 'utf-8' }).split("})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  '\\n',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:")[0]"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:" "}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"const cpuLen = cpus().length"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"module.exports = {"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"  apps: ["})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"    {"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      name: 'mx-server',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"#4BB74A"},children:"+     script: 'out/index.js --db_host=远端地址 --db_user=mongodb-test --db_password=db?passwd',"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      autorestart: true,"})}),"\n",(0,r.jsx)(e.span,{className:"line",children:(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:"      exec_mode: 'cluster',"})})]})}),"\n",(0,r.jsx)(e.p,{children:"当你修改完成，你需要重新构建，并重启服务："}),"\n",(0,r.jsx)(e.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,r.jsxs)(e.code,{"data-language":"bash","data-theme":"default",children:[(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"bundle"})]}),"\n",(0,r.jsxs)(e.span,{className:"line",children:[(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,r.jsx)(e.span,{style:{color:"var(--shiki-token-string)"},children:"prod:pm2"})]})]})})]})}e.default=(0,o.j)({MDXContent:function(){let s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,n.ah)(),s.components);return e?(0,r.jsx)(e,{...s,children:(0,r.jsx)(c,{...s})}):c(s)},pageOpts:{filePath:"pages/docs/extra.mdx",route:"/docs/extra",headings:[{depth:1,value:"拓展内容",id:"拓展内容"},{depth:2,value:"反向代理",id:"反向代理"},{depth:3,value:"双域名",id:"双域名"},{depth:3,value:"单域名",id:"单域名"},{depth:2,value:"配置其他 Redis 服务",id:"配置其他-redis-服务"},{depth:3,value:"对于进阶部署",id:"对于进阶部署"},{depth:2,value:"配置其他 MongoDB 服务",id:"配置其他-mongodb-服务"},{depth:3,value:"对于进阶部署",id:"对于进阶部署-1"}],title:"拓展内容"},pageNextRoute:"/docs/extra"})}},function(s){s.O(0,[985,774,888,179],function(){return s(s.s=9294)}),_N_E=s.O()}]);