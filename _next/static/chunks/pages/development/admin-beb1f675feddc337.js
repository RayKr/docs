(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[585],{4374:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/development/admin",function(){return n(9007)}])},9007:function(e,s,n){"use strict";n.r(s);var l=n(1527),i=n(985),a=n(6736);n(8823);var t=n(5032);function r(e){let s=Object.assign({h1:"h1",p:"p",ul:"ul",li:"li",a:"a",h2:"h2",pre:"pre",code:"code",span:"span"},(0,a.ah)(),e.components);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.h1,{children:"后台单独部署"}),"\n","\n",(0,l.jsx)(s.p,{children:"在正常情况下，你不需要单独部署后台，因为后台已经被打包到了后端中。"}),"\n",(0,l.jsx)(s.p,{children:"如果你有以下需求："}),"\n",(0,l.jsxs)(s.ul,{children:["\n",(0,l.jsx)(s.li,{children:"想使用其他域名作为后台地址"}),"\n",(0,l.jsx)(s.li,{children:"想使用其他端口作为后台地址"}),"\n"]}),"\n",(0,l.jsxs)(s.p,{children:["那么你可以选择单独部署后台，或者你可以参考 ",(0,l.jsx)(s.a,{href:"/themes/kami#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86",children:"反向代理配置"}),"。"]}),"\n",(0,l.jsx)(s.h2,{id:"拉取源文件",children:"拉取源文件"}),"\n",(0,l.jsx)(s.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"cd"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"mx-space"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"git"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"clone"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"https://github.com/mx-space/mx-admin.git"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"--depth"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-constant)"},children:"1"})]})]})}),"\n",(0,l.jsx)(s.h2,{id:"修改配置文件",children:"修改配置文件"}),"\n",(0,l.jsxs)(s.p,{children:["进入到后台源码目录，找到 ",(0,l.jsx)(s.code,{children:".env.production"})," 文件，取消对应配置项的注释，然后修改为你的配置。"]}),"\n",(0,l.jsx)(s.p,{children:"例如："}),"\n",(0,l.jsx)(s.pre,{"data-language":"txt","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(s.code,{"data-language":"txt","data-theme":"default",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"VITE_APP_BASE_API=https://server.test.cn/api/v2"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"VITE_APP_WEB_URL=https://www.test.cn"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"VITE_APP_GATEWAY=https://server.test.cn"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"# # VITE_APP_PUBLIC_URL=https://fastly.jsdelivr.net/gh/mx-space/admin-next@gh-pages/"})})]})}),"\n",(0,l.jsxs)(s.p,{children:["其他可以定义的配置在文件 ",(0,l.jsx)(s.code,{children:"/src/configs.ts"})," 中。"]}),"\n",(0,l.jsx)(s.h2,{id:"构建",children:"构建"}),"\n",(0,l.jsxs)(t.UW,{type:"warning",emoji:"⚠️",children:[(0,l.jsx)(s.p,{children:"构建 mx-admin 需要的内存至少为 2 Gib，如果你服务器内存不足，你可以在本地构建成功后，将产物上传到服务器。"}),(0,l.jsx)(s.p,{children:"在 Windows 系统上，mx-admin 无法正常构建，你可以使用 WSL2 或者 Linux 系统。"})]}),"\n",(0,l.jsx)(s.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(s.code,{"data-language":"bash","data-theme":"default",children:[(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"i"})]}),"\n",(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"pnpm"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"build"})]})]})}),"\n",(0,l.jsx)(s.h2,{id:"部署产物",children:"部署产物"}),"\n",(0,l.jsx)(s.p,{children:"构建生成的产物在 dist 目录下，你可以直接把它们移动到你准备好的后台网站的根目录下。"}),"\n",(0,l.jsxs)(s.p,{children:["假设你准备的后台网站域名是 ",(0,l.jsx)(s.code,{children:"admin.test.cn"}),"，"]}),"\n",(0,l.jsxs)(s.p,{children:["网站根目录为 ",(0,l.jsx)(s.code,{children:"/var/www/admin.test.cn/"}),"，"]}),"\n",(0,l.jsxs)(s.p,{children:["那么，你把 dist 目录下的所有文件移动到 ",(0,l.jsx)(s.code,{children:"/var/www/admin.test.cn/"})," 目录下即可。"]}),"\n",(0,l.jsx)(s.h2,{id:"修改后端配置",children:"修改后端配置"}),"\n",(0,l.jsxs)(s.p,{children:["编辑 Core 的 ",(0,l.jsx)(s.code,{children:".env"})," 文件，修改 ",(0,l.jsx)(s.code,{children:"ALLOWED_ORIGINS"})," ，添加你的后台域名。"]}),"\n",(0,l.jsxs)(s.p,{children:["示例域名为 ",(0,l.jsx)(s.code,{children:"admin.test.cn"})," 。"]}),"\n",(0,l.jsx)(s.p,{children:"例如："}),"\n",(0,l.jsx)(s.pre,{"data-language":"txt","data-theme":"default",hasCopyCode:!0,children:(0,l.jsxs)(s.code,{"data-language":"txt","data-theme":"default",children:[(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"# THIS ENV FILE EXAMPLE ONLY FOR DOCKER COMPOSE"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"# SEE https://docs.docker.com/compose/environment-variables/#the-env-file"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"JWT_SECRET=7294c34e0b28ad28          #此处填写一个长度不小于 16 个字符，不大于 32 个字符的字符串"})}),"\n",(0,l.jsx)(s.span,{className:"line",children:(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:"ALLOWED_ORIGINS=test.cn,www.test.cn,admin.test.cn"})})]})}),"\n",(0,l.jsx)(s.p,{children:"然后重新启动 Core 即可："}),"\n",(0,l.jsx)(s.pre,{"data-language":"bash","data-theme":"default",hasCopyCode:!0,children:(0,l.jsx)(s.code,{"data-language":"bash","data-theme":"default",children:(0,l.jsxs)(s.span,{className:"line",children:[(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-function)"},children:"docker"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"compose"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"up"}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,l.jsx)(s.span,{style:{color:"var(--shiki-token-string)"},children:"-d"})]})})})]})}s.default=(0,i.j)({MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.ah)(),e.components);return s?(0,l.jsx)(s,{...e,children:(0,l.jsx)(r,{...e})}):r(e)},pageOpts:{filePath:"pages/development/admin.mdx",route:"/development/admin",headings:[{depth:1,value:"后台单独部署",id:"后台单独部署"},{depth:2,value:"拉取源文件",id:"拉取源文件"},{depth:2,value:"修改配置文件",id:"修改配置文件"},{depth:2,value:"构建",id:"构建"},{depth:2,value:"部署产物",id:"部署产物"},{depth:2,value:"修改后端配置",id:"修改后端配置"}],title:"后台单独部署"},pageNextRoute:"/development/admin"})}},function(e){e.O(0,[76,774,888,179],function(){return e(e.s=4374)}),_N_E=e.O()}]);